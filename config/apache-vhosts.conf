LoadModule rewrite_module modules/mod_rewrite.so
LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_http_module modules/mod_proxy_http.so
LoadModule proxy_wstunnel_module modules/mod_proxy_wstunnel.so

# ByGagoos-Ink Frontend
<VirtualHost *:80>
    ServerName bygagoos-ink.local
    ServerAlias localhost
    DocumentRoot "C:/xampp/htdocs/bygagoos-ink"
    
    <Directory "C:/xampp/htdocs/bygagoos-ink">
        Options Indexes FollowSymLinks MultiViews
        AllowOverride All
        Require all granted
        
        # Réécriture pour SPA React
        <IfModule mod_rewrite.c>
            RewriteEngine On
            RewriteBase /
            RewriteRule ^index\.html$ - [L]
            RewriteCond %{REQUEST_FILENAME} !-f
            RewriteCond %{REQUEST_FILENAME} !-d
            RewriteRule . /index.html [L]
        </IfModule>
    </Directory>
    
    # Proxy vers l'API Node.js
    <IfModule mod_proxy.c>
        ProxyRequests Off
        ProxyPreserveHost On
        
        # API endpoints
        ProxyPass /api http://localhost:3001/api
        ProxyPassReverse /api http://localhost:3001/api
        
        # WebSocket support (si nécessaire)
        ProxyPass /ws ws://localhost:3001/ws
        ProxyPassReverse /ws ws://localhost:3001/ws
    </IfModule>
    
    # CORS Headers
    Header set Access-Control-Allow-Origin "*"
    Header set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
    Header set Access-Control-Allow-Headers "Content-Type, Authorization"
    
    ErrorLog "logs/bygagoos-ink-error.log"
    CustomLog "logs/bygagoos-ink-access.log" combined
</VirtualHost>

# Configuration SSL/HTTPS (optional)
<VirtualHost *:443>
    ServerName bygagoos-ink.local
    DocumentRoot "C:/xampp/htdocs/bygagoos-ink"
    
    SSLEngine on
    SSLCertificateFile "C:/xampp/apache/certs/server.crt"
    SSLCertificateKeyFile "C:/xampp/apache/certs/server.key"
    
    <Directory "C:/xampp/htdocs/bygagoos-ink">
        Options Indexes FollowSymLinks MultiViews
        AllowOverride All
        Require all granted
        
        <IfModule mod_rewrite.c>
            RewriteEngine On
            RewriteBase /
            RewriteRule ^index\.html$ - [L]
            RewriteCond %{REQUEST_FILENAME} !-f
            RewriteCond %{REQUEST_FILENAME} !-d
            RewriteRule . /index.html [L]
        </IfModule>
    </Directory>
    
    <IfModule mod_proxy.c>
        ProxyRequests Off
        ProxyPreserveHost On
        ProxyPass /api http://localhost:3001/api
        ProxyPassReverse /api http://localhost:3001/api
    </IfModule>
    
    ErrorLog "logs/bygagoos-ink-ssl-error.log"
    CustomLog "logs/bygagoos-ink-ssl-access.log" combined
</VirtualHost>
