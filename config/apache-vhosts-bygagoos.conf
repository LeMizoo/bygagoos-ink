# ByGagoos-Ink Virtual Host Configuration for Apache
# 
# FILE: C:\xampp\apache\conf\extra\httpd-vhosts.conf
# 
# INSTRUCTIONS:
# 1. Copy this entire block and paste it at the end of httpd-vhosts.conf
# 2. Change DocumentRoot and Directory paths if your XAMPP is not in C:\xampp
# 3. Save the file
# 4. Run: httpd -t (in Apache bin folder) to validate syntax
# 5. Restart Apache from XAMPP Control Panel

# ============================================
# ByGagoos-Ink Virtual Host
# ============================================

<VirtualHost *:80>
    ServerName bygagoos-ink.local
    ServerAlias bygagoos-ink
    DocumentRoot "C:\xampp\htdocs\bygagoos-ink\public"
    
    <Directory "C:\xampp\htdocs\bygagoos-ink\public">
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
        
        # Enable mod_rewrite for SPA routing
        <IfModule mod_rewrite.c>
            RewriteEngine On
            RewriteBase /
            
            # Don't rewrite existing files or directories
            RewriteCond %{REQUEST_FILENAME} !-f
            RewriteCond %{REQUEST_FILENAME} !-d
            
            # Rewrite all other requests to index.html
            RewriteRule ^(.*)$ index.html [L]
        </IfModule>
    </Directory>

    # Proxy API requests to Node.js backend
    <IfModule mod_proxy.c>
        ProxyPreserveHost On
        
        # Proxy /api to Node.js
        ProxyPass /api http://localhost:3001/api
        ProxyPassReverse /api http://localhost:3001/api
        
        # Don't proxy WebSocket upgrades
        ProxyPass /ws !
    </IfModule>

    # Enable gzip compression
    <IfModule mod_deflate.c>
        AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript
    </IfModule>

    # Cache control for assets
    <FilesMatch "\.(jpg|jpeg|png|gif|ico|css|js|svg|woff|woff2|ttf|eot)$">
        Header set Cache-Control "max-age=31536000, public"
    </FilesMatch>
    
    # No cache for HTML
    <FilesMatch "\.html$">
        Header set Cache-Control "no-cache, no-store, must-revalidate"
    </FilesMatch>

    # Logging
    ErrorLog "logs/bygagoos-ink-error.log"
    CustomLog "logs/bygagoos-ink-access.log" combined
</VirtualHost>

# ============================================
# Additional configuration notes
# ============================================

# If you need HTTPS:
# <VirtualHost *:443>
#     ServerName bygagoos-ink.local
#     DocumentRoot "C:\xampp\htdocs\bygagoos-ink\public"
#     
#     SSLEngine on
#     SSLCertificateFile "conf/ssl.crt/server.crt"
#     SSLCertificateKeyFile "conf/ssl.key/server.key"
#     
#     # Same proxy and rewrite rules as above
# </VirtualHost>

# If Apache modules are not enabled, enable them in httpd.conf:
# LoadModule rewrite_module modules/mod_rewrite.so
# LoadModule proxy_module modules/mod_proxy.so
# LoadModule proxy_http_module modules/mod_proxy_http.so
# LoadModule deflate_module modules/mod_deflate.so
# LoadModule headers_module modules/mod_headers.so
