@echo off
cls
color 0A
echo.
echo  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó    ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó
echo ‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù ‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù    ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë ‚ñà‚ñà‚ïî‚ïù
echo ‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ñà‚ïó ‚ïö‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù ‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó    ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù 
echo ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë  ‚ïö‚ñà‚ñà‚ïî‚ïù  ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïë    ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ñà‚ñà‚ïó 
echo ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù   ‚ñà‚ñà‚ïë   ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë    ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë ‚ïö‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïó
echo  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù    ‚ïö‚ïê‚ïù    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù    ‚ñö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù
echo.
echo ================================ BYGAGOOS INK ================================
echo.

:menu
echo 1. üîß D√©marrer Backend (Mode Local SQLite)
echo 2. üóÑÔ∏è  Initialiser la base de donn√©es
echo 3. üë• Cr√©er des utilisateurs de test
echo 4. üåê Tester l'API
echo 5. üöÄ D√©marrer avec Docker (si disponible)
echo 6. ‚ùå Quitter
echo.
set /p choice="Choisissez une option (1-6): "

if "%choice%"=="1" goto start_backend
if "%choice%"=="2" goto init_db
if "%choice%"=="3" goto create_users
if "%choice%"=="4" goto test_api
if "%choice%"=="5" goto start_docker
if "%choice%"=="6" goto exit

echo Choix invalide
goto menu

:start_backend
echo.
echo üîß Arr√™t des processus Node...
taskkill /F /IM node.exe 2>nul
echo üîß G√©n√©ration du client Prisma...
npx prisma generate
echo üóÑÔ∏è  Cr√©ation de la base de donn√©es SQLite...
npx prisma db push
echo üöÄ D√©marrage du Backend en mode LOCAL...
echo.
start "ByGagoos Backend - Mode Local" cmd /k "npm run dev"
echo.
echo ‚úÖ BACKEND D√âMARR√â EN MODE LOCAL !
goto show_urls

:init_db
echo.
echo üóÑÔ∏è  Initialisation de la base de donn√©es SQLite...
npx prisma generate
npx prisma db push
echo ‚úÖ Base de donn√©es initialis√©e !
pause
goto menu

:create_users
echo.
echo üë• Cr√©ation des utilisateurs de test...
echo.
node -e "
const { PrismaClient } = require('@prisma/client');
const bcrypt = require('bcryptjs');
const prisma = new PrismaClient();

async function createUsers() {
  try {
    // Vider la table users
    await prisma.user.deleteMany({});
    
    // Cr√©er les utilisateurs
    const users = [
      {
        email: 'tovoniaina.rahendrison@gmail.com',
        password: await bcrypt.hash('ByGagoos2025!', 10),
        name: 'Tovoniaina',
        role: 'STRUCTURE',
        description: 'Fondateur & Responsable Structure',
        color: '#2E7D32'
      },
      {
        email: 'volatiana@bygagoos.com',
        password: await bcrypt.hash('ByGagoos2025!', 10),
        name: 'Volatiana',
        role: 'INSPIRATION',
        description: 'Responsable Inspiration & Cr√©ativit√©',
        color: '#9C27B0'
      },
      {
        email: 'miantsatiana@bygagoos.com',
        password: await bcrypt.hash('ByGagoos2025!', 10),
        name: 'Miantsatiana',
        role: 'CREATION',
        description: 'Responsable Cr√©ation & Production',
        color: '#FF9800'
      },
      {
        email: 'tiafaniry@bygagoos.com',
        password: await bcrypt.hash('ByGagoos2025!', 10),
        name: 'Tia Faniry',
        role: 'COMMUNICATION',
        description: 'Responsable Communication & Marketing',
        color: '#2196F3'
      }
    ];
    
    for (const userData of users) {
      await prisma.user.create({ data: userData });
      console.log('‚úÖ Cr√©√©: ' + userData.name + ' (' + userData.email + ')');
    }
    
    console.log('\\nüéâ ' + users.length + ' utilisateurs cr√©√©s !');
    console.log('üîê Mot de passe pour tous: ByGagoos2025!');
    
  } catch (error) {
    console.error('‚ùå Erreur:', error.message);
  } finally {
    await prisma.\$disconnect();
  }
}

createUsers();
"
echo.
pause
goto menu

:test_api
echo.
echo üåê Test de l'API...
echo.
echo 1. Test de sant√©:
curl -s http://localhost:3001/api/health 2>nul
echo.
echo 2. Nombre d'utilisateurs:
curl -s http://localhost:3001/api/health 2>nul | findstr "users"
echo.
echo 3. Test de connexion (si backend d√©marr√©):
echo    Email: tovoniaina.rahendrison@gmail.com
echo    Password: ByGagoos2025!
echo.
pause
goto menu

:start_docker
echo.
echo üê≥ D√©marrage avec Docker (optionnel)...
echo ‚ö†Ô∏è  Assurez-vous que Docker Desktop est d√©marr√©
docker-compose down 2>nul
docker-compose up -d 2>nul
echo.
echo ‚úÖ Docker d√©marr√© (si disponible)
goto show_urls

:show_urls
echo.
echo ================================
echo üåê URLs IMPORTANTES :
echo    Backend API : http://localhost:3001
echo    Frontend : http://localhost:5173
echo    Health Check : http://localhost:3001/api/health
echo.
echo üîê IDENTIFIANTS DE TEST :
echo    Email : tovoniaina.rahendrison@gmail.com
echo    Password : ByGagoos2025!
echo    R√¥les : STRUCTURE, INSPIRATION, CREATION, COMMUNICATION
echo ================================
echo.
echo üí° COMMANDES UTILES :
echo    npm run dev          - D√©marrer le backend
echo    npx prisma studio    - Interface base de donn√©es
echo    npx prisma db push   - Mettre √† jour la base
echo.
pause
goto menu

:exit
echo.
echo Au revoir ! üëã
timeout 2
exit