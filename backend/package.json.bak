{
  "name": "bygagoos-ink-backend",
  "version": "2.2.0",
  "description": "Backend API pour ByGagoos-Ink - Multi-database (PostgreSQL/SQLite) avec Prisma",
  "main": "app.js",
  "type": "commonjs",
  "scripts": {
    "start": "node app.js",
    "dev": "nodemon app.js",
    "dev:docker": "docker-compose up -d && docker-compose logs -f backend",
    "dev:local": "DATABASE_URL=\"postgresql://postgres:password@localhost:5432/bygagoos_ink?schema=public\" nodemon app.js",
    "dev:sqlite": "DATABASE_URL=\"file:./dev.db\" nodemon app.js",
    
    "build": "npm install && npx prisma generate",
    "build:sqlite": "DATABASE_URL=\"file:./dev.db\" npm install && npx prisma generate",
    "build:postgres": "DATABASE_URL=\"postgresql://postgres:password@localhost:5432/bygagoos_ink?schema=public\" npm install && npx prisma generate",
    
    "seed": "node scripts/seed.js",
    "seed:docker": "node scripts/seed-docker.js",
    "seed:sqlite": "node scripts/seed-sqlite.js",
    "seed:postgres": "DATABASE_URL=\"postgresql://postgres:password@localhost:5432/bygagoos_ink?schema=public\" node scripts/seed.js",
    
    "prisma:generate": "npx prisma generate",
    "prisma:migrate": "npx prisma migrate dev --name init",
    "prisma:reset": "npx prisma migrate reset --force",
    "prisma:studio": "npx prisma studio",
    "prisma:db-push": "npx prisma db push --accept-data-loss",
    "prisma:db-push:local": "DATABASE_URL=\"postgresql://postgres:password@localhost:5432/bygagoos_ink?schema=public\" npx prisma db push --accept-data-loss",
    "prisma:db-push:sqlite": "DATABASE_URL=\"file:./dev.db\" npx prisma db push --accept-data-loss",
    
    "setup": "npm install && npx prisma generate && npx prisma db push --accept-data-loss && npm run seed",
    "setup:local": "DATABASE_URL=\"postgresql://postgres:password@localhost:5432/bygagoos_ink?schema=public\" npm install && npx prisma generate && npx prisma db push --accept-data-loss && npm run seed:postgres",
    "setup:sqlite": "npm install && npx prisma generate && npx prisma db push --accept-data-loss && npm run seed:sqlite",
    "setup:docker": "docker-compose down && docker-compose up -d --build && sleep 10 && docker-compose exec backend npm run seed:docker",
    "setup:docker:sqlite": "docker-compose down && DATABASE_URL=\"file:/app/data/dev.db\" docker-compose up -d --build && sleep 5 && docker-compose exec backend npm run seed:sqlite",
    
    "docker:build": "docker build -t bygagoos-backend .",
    "docker:run": "docker run -p 3001:3001 --env-file .env --name bygagoos-backend bygagoos-backend",
    "docker:compose:up": "docker-compose up -d",
    "docker:compose:down": "docker-compose down",
    "docker:compose:logs": "docker-compose logs -f",
    "docker:compose:restart": "docker-compose restart",
    "docker:compose:rebuild": "docker-compose up -d --build --force-recreate",
    "docker:sqlite": "docker-compose down && docker-compose up -d --build",
    
    "health": "curl -f http://localhost:3001/api/health || echo '❌ API non disponible'",
    "health:docker": "docker-compose exec backend curl -f http://localhost:3001/api/health || echo '❌ API Docker non disponible'",
    "db:health": "docker-compose exec postgres pg_isready -U postgres 2>/dev/null || echo '⚠️ PostgreSQL non disponible (mode SQLite?)'",
    
    "test": "echo '✅ Tests à implémenter' && exit 0",
    "test:api": "curl -s http://localhost:3001/api/health | jq . || echo '⚠️ Installez jq pour un meilleur formatage: npm install -g jq'",
    "test:docker": "docker-compose exec backend npm test",
    "test:login": "curl -X POST http://localhost:3001/api/auth/login -H 'Content-Type: application/json' -d '{\"email\":\"tovoniaina.rahendrison@gmail.com\",\"password\":\"ByGagoos2025!\"}' | jq . || echo 'Test login échoué'",
    
    "logs": "docker-compose logs -f",
    "logs:backend": "docker-compose logs -f backend",
    "logs:postgres": "docker-compose logs -f postgres 2>/dev/null || echo '⚠️ PostgreSQL non démarré (mode SQLite)'",
    
    "stop": "docker-compose down",
    "clean": "docker-compose down -v && docker system prune -f",
    "clean:all": "docker-compose down -v --remove-orphans && docker system prune -af && docker volume prune -f",
    "clean:sqlite": "rm -f dev.db && rm -f dev.db-journal",
    
    "status": "docker-compose ps && echo '' && npm run health",
    "status:docker": "docker-compose ps && echo '' && npm run health:docker",
    "status:local": "ps aux | grep -E '(node|nodemon)' | grep -v grep || echo '⚠️ Serveur local non démarré' && curl -s http://localhost:3001/api/health || echo '❌ API non disponible'",
    
    "db:backup": "docker-compose exec -T postgres pg_dump -U postgres bygagoos_ink > backup_$(date +%Y%m%d_%H%M%S).sql 2>/dev/null || echo '⚠️ PostgreSQL non disponible - backup SQLite' && cp dev.db backup_sqlite_$(date +%Y%m%d_%H%M%S).db 2>/dev/null || true",
    "db:restore": "echo 'Usage pour PostgreSQL: cat backup_file.sql | docker-compose exec -T postgres psql -U postgres -d bygagoos_ink' && echo 'Usage pour SQLite: cp backup_file.db dev.db'",
    "db:shell": "docker-compose exec postgres psql -U postgres -d bygagoos_ink 2>/dev/null || echo '⚠️ PostgreSQL non disponible - Mode SQLite actif'",
    "db:reset": "docker-compose exec postgres psql -U postgres -d bygagoos_ink -c 'DROP SCHEMA public CASCADE; CREATE SCHEMA public;' 2>/dev/null || echo '⚠️ Réinitialisation PostgreSQL échouée (mode SQLite?)'",
    
    "prisma:docker:generate": "docker-compose exec backend npx prisma generate",
    "prisma:docker:push": "docker-compose exec backend npx prisma db push --accept-data-loss",
    "prisma:docker:migrate": "docker-compose exec backend npx prisma migrate dev --name docker-migration",
    "prisma:docker:studio": "docker-compose exec -p 5555:5555 backend npx prisma studio",
    "prisma:docker:reset": "docker-compose exec backend npx prisma migrate reset --force",
    
    "debug:env": "echo '=== ENV VARIABLES ===' && grep -v '^#' .env || echo '⚠️ .env non trouvé'",
    "debug:db": "curl -s http://localhost:3001/api/debug/db || echo '❌ Debug endpoint non disponible'",
    "debug:create-test-user": "curl -X POST http://localhost:3001/api/debug/create-test-user || echo '❌ Endpoint non disponible'",
    "list:routes": "curl -s http://localhost:3001/ | jq .endpoints || echo '❌ API non disponible'"
  },
  "dependencies": {
    "@prisma/client": "^5.7.0",
    "bcryptjs": "^2.4.3",
    "cors": "^2.8.5",
    "dotenv": "^16.3.1",
    "express": "^4.18.2",
    "helmet": "^7.1.0",
    "jsonwebtoken": "^9.0.2",
    "morgan": "^1.10.0",
    "multer": "^1.4.5-lts.1"
  },
  "devDependencies": {
    "nodemon": "^3.0.1",
    "prisma": "^5.7.0"
  },
  "keywords": [
    "bygagoos",
    "family",
    "business",
    "api",
    "postgresql",
    "sqlite",
    "prisma",
    "docker",
    "nodejs",
    "express"
  ],
  "author": "BYGAGOOS FAMILY",
  "license": "MIT",
  "prisma": {
    "schema": "prisma/schema.prisma",
    "seed": "node scripts/seed.js"
  },
  "engines": {
    "node": ">=18.0.0",
    "npm": ">=8.0.0"
  },
  "repository": {
    "type": "git",
    "url": "https://github.com/bygagoos/bygagoos-ink-backend.git"
  },
  "bugs": {
    "url": "https://github.com/bygagoos/bygagoos-ink-backend/issues"
  },
  "homepage": "https://github.com/bygagoos/bygagoos-ink-backend#readme",
  "config": {
    "supportedDatabases": ["postgresql", "sqlite"],
    "defaultPort": 3001,
    "defaultEmail": "tovoniaina.rahendrison@gmail.com",
    "defaultPassword": "ByGagoos2025!"
  }
}