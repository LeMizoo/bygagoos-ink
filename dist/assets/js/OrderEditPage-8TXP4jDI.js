import{h as e,u as s,b as t,L as a}from"./vendor-CdERBfzr.js";import{f as l,F as r,g as n,h as i,e as c,i as o,j as d,b as m,k as x,l as u}from"./index.esm-DiZYQx0V.js";import{j as g}from"./index-CHAJO785.js";const p=()=>{const{id:p}=e(),h=s(),[b,j]=t.useState(!0),[y,N]=t.useState(null),[f,v]=t.useState({clientName:"",clientEmail:"",clientPhone:"",orderNumber:"",status:"en_attente",totalAmount:"",dueDate:"",notes:"",items:[]});t.useEffect(()=>{setTimeout(()=>{const e={id:parseInt(p),orderNumber:`CMD-2024-${String(p).padStart(3,"0")}`,clientName:"SARL Malagasy Style",clientEmail:"contact@malagasy-style.mg",clientPhone:"+261 34 12 345 67",status:"en_production",totalAmount:"1 250 000 Ar",dueDate:"2024-01-30",createdAt:"2024-01-15",items:[{id:1,name:"T-shirts Sérigraphiés",quantity:100,unitPrice:"8 000",total:"800 000 Ar"},{id:2,name:"Casquettes Brodées",quantity:50,unitPrice:"5 000",total:"250 000 Ar"},{id:3,name:"Stickers Personnalisés",quantity:200,unitPrice:"1 000",total:"200 000 Ar"}],notes:"Livraison prévue à l&apos;adresse du client. Contactez le client avant la livraison."};N(e),v({clientName:e.clientName,clientEmail:e.clientEmail,clientPhone:e.clientPhone,orderNumber:e.orderNumber,status:e.status,totalAmount:e.totalAmount,dueDate:e.dueDate,notes:e.notes,items:[...e.items]}),j(!1)},1e3)},[p]);const w=e=>{const{name:s,value:t}=e.target;v(e=>({...e,[s]:t}))},C=(e,s,t)=>{const a=[...f.items];if(a[e]={...a[e],[s]:t},"quantity"===s||"unitPrice"===s){const s=parseInt(a[e].quantity)||0,t=parseInt(a[e].unitPrice.replace(/\D/g,""))||0;a[e].total=(s*t).toLocaleString("fr-MG")+" Ar"}v(e=>({...e,items:a}))},k=()=>f.items.reduce((e,s)=>e+(parseInt(s.total.replace(/\D/g,""))||0),0).toLocaleString("fr-MG")+" Ar",A=()=>{window.print()};return b?g.jsx("div",{className:"p-6",children:g.jsxs("div",{className:"animate-pulse",children:[g.jsx("div",{className:"h-8 bg-gray-200 rounded-lg w-64 mb-6"}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[g.jsx("div",{className:"lg:col-span-2 h-96 bg-white rounded-xl shadow-sm"}),g.jsx("div",{className:"h-96 bg-white rounded-xl shadow-sm"})]})]})}):y?g.jsxs("div",{className:"p-6 order-edit-page",children:[g.jsxs("div",{className:"flex items-center justify-between mb-8",children:[g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsxs("button",{onClick:()=>h("/app/orders"),className:"inline-flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[g.jsx(r,{}),"Retour"]}),g.jsxs("div",{children:[g.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Édition de commande"}),g.jsxs("p",{className:"text-gray-600 mt-1",children:[f.orderNumber," • ",f.clientName]})]})]}),g.jsxs("div",{className:"flex gap-3",children:[g.jsxs("button",{onClick:A,className:"inline-flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[g.jsx(n,{}),"Imprimer"]}),g.jsxs("button",{onClick:()=>{alert(`Email envoyé au client: ${f.clientEmail}`)},className:"inline-flex items-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[g.jsx(i,{}),"Envoyer"]}),g.jsxs("button",{onClick:()=>{alert("Commande mise à jour avec succès !"),h("/app/orders")},className:"inline-flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[g.jsx(c,{}),"Enregistrer"]})]})]}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[g.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[g.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[g.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations générales"}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Numéro de commande"}),g.jsx("input",{type:"text",name:"orderNumber",value:f.orderNumber,onChange:w,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut"}),g.jsxs("select",{name:"status",value:f.status,onChange:w,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[g.jsx("option",{value:"nouveau",children:"Nouveau"}),g.jsx("option",{value:"en_attente",children:"En attente"}),g.jsx("option",{value:"en_production",children:"En production"}),g.jsx("option",{value:"termine",children:"Terminé"}),g.jsx("option",{value:"livre",children:"Livré"}),g.jsx("option",{value:"annule",children:"Annulé"})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom du client"}),g.jsx("input",{type:"text",name:"clientName",value:f.clientName,onChange:w,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email du client"}),g.jsx("input",{type:"email",name:"clientEmail",value:f.clientEmail,onChange:w,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Téléphone"}),g.jsx("input",{type:"tel",name:"clientPhone",value:f.clientPhone,onChange:w,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date d'échéance"}),g.jsx("input",{type:"date",name:"dueDate",value:f.dueDate,onChange:w,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),g.jsxs("div",{className:"md:col-span-2",children:[g.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),g.jsx("textarea",{name:"notes",value:f.notes,onChange:w,rows:"4",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),g.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[g.jsxs("div",{className:"flex items-center justify-between mb-4",children:[g.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Articles commandés"}),g.jsxs("button",{onClick:()=>{const e={id:f.items.length+1,name:"",quantity:1,unitPrice:"0",total:"0 Ar"};v(s=>({...s,items:[...s.items,e]}))},className:"inline-flex items-center gap-2 px-4 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors",children:[g.jsx(o,{}),"Ajouter un article"]})]}),g.jsx("div",{className:"overflow-x-auto",children:g.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[g.jsx("thead",{children:g.jsxs("tr",{children:[g.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Article"}),g.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantité"}),g.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Prix unitaire"}),g.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),g.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),g.jsx("tbody",{className:"divide-y divide-gray-200",children:f.items.map((e,s)=>g.jsxs("tr",{children:[g.jsx("td",{className:"px-4 py-3",children:g.jsx("input",{type:"text",value:e.name,onChange:e=>C(s,"name",e.target.value),className:"w-full px-3 py-1 border border-gray-300 rounded-lg",placeholder:"Nom de l'article"})}),g.jsx("td",{className:"px-4 py-3",children:g.jsx("input",{type:"number",value:e.quantity,onChange:e=>C(s,"quantity",e.target.value),className:"w-24 px-3 py-1 border border-gray-300 rounded-lg text-center",min:"1"})}),g.jsx("td",{className:"px-4 py-3",children:g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx("input",{type:"text",value:e.unitPrice,onChange:e=>C(s,"unitPrice",e.target.value),className:"w-32 px-3 py-1 border border-gray-300 rounded-lg",placeholder:"0 Ar"}),g.jsx("span",{className:"text-gray-500",children:"Ar"})]})}),g.jsx("td",{className:"px-4 py-3 font-medium text-gray-900",children:e.total}),g.jsx("td",{className:"px-4 py-3",children:g.jsx("button",{onClick:()=>(e=>{const s=f.items.filter((s,t)=>t!==e);v(e=>({...e,items:s}))})(s),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:g.jsx(d,{})})})]},e.id))}),g.jsx("tfoot",{children:g.jsxs("tr",{children:[g.jsx("td",{colSpan:"3",className:"px-4 py-3 text-right font-bold text-gray-700",children:"Total général:"}),g.jsx("td",{colSpan:"2",className:"px-4 py-3 font-bold text-lg text-green-600",children:k()})]})})]})})]})]}),g.jsxs("div",{className:"space-y-6",children:[g.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[g.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Résumé"}),g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("span",{className:"text-gray-600",children:"Statut actuel:"}),(e=>{const s={nouveau:{label:"Nouveau",color:"bg-blue-100 text-blue-800"},en_attente:{label:"En attente",color:"bg-yellow-100 text-yellow-800"},en_production:{label:"En production",color:"bg-purple-100 text-purple-800"},termine:{label:"Terminé",color:"bg-green-100 text-green-800"},livre:{label:"Livré",color:"bg-indigo-100 text-indigo-800"},annule:{label:"Annulé",color:"bg-red-100 text-red-800"}}[e]||{label:e,color:"bg-gray-100 text-gray-800"};return g.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${s.color}`,children:s.label})})(f.status)]}),g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("span",{className:"text-gray-600",children:"Date création:"}),g.jsx("span",{className:"font-medium",children:y.createdAt})]}),g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("span",{className:"text-gray-600",children:"Date échéance:"}),g.jsx("span",{className:"font-medium",children:f.dueDate})]}),g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("span",{className:"text-gray-600",children:"Nombre d'articles:"}),g.jsx("span",{className:"font-medium",children:f.items.length})]}),g.jsx("div",{className:"pt-4 border-t",children:g.jsxs("div",{className:"flex items-center justify-between text-lg",children:[g.jsx("span",{className:"font-bold",children:"Total:"}),g.jsx("span",{className:"font-bold text-green-600",children:k()})]})})]})]}),g.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[g.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[g.jsx(m,{className:"w-5 h-5"}),"Client"]}),g.jsxs("div",{className:"space-y-3",children:[g.jsxs("div",{children:[g.jsx("p",{className:"font-medium text-gray-900",children:f.clientName}),g.jsx("p",{className:"text-sm text-gray-600",children:f.clientEmail}),g.jsx("p",{className:"text-sm text-gray-600",children:f.clientPhone})]}),g.jsxs(a,{to:"/app/clients",className:"block w-full px-4 py-2 text-center border border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 transition-colors",children:[g.jsx(m,{className:"inline mr-2"}),"Voir fiche client"]})]})]}),g.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[g.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Actions rapides"}),g.jsxs("div",{className:"space-y-3",children:[g.jsxs("button",{onClick:()=>v(e=>({...e,status:"termine"})),className:"w-full px-4 py-3 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors flex items-center justify-center gap-2",children:[g.jsx(x,{}),"Marquer comme terminé"]}),g.jsxs("button",{onClick:A,className:"w-full px-4 py-3 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors flex items-center justify-center gap-2",children:[g.jsx(u,{}),"Télécharger le bon"]}),g.jsxs("button",{onClick:()=>{window.confirm("Êtes-vous sûr de vouloir annuler cette commande ?")&&(alert("Commande annulée avec succès !"),h("/app/orders"))},className:"w-full px-4 py-3 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors flex items-center justify-center gap-2",children:[g.jsx(l,{}),"Annuler la commande"]})]})]})]})]})]}):g.jsx("div",{className:"p-6",children:g.jsx("div",{className:"bg-white rounded-xl shadow-sm p-8",children:g.jsxs("div",{className:"text-center py-12",children:[g.jsx(l,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),g.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Commande non trouvée"}),g.jsxs("p",{className:"text-gray-600 mb-6",children:["La commande avec l'ID ",p," n'existe pas ou a été supprimée."]}),g.jsxs("button",{onClick:()=>h("/app/orders"),className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[g.jsx(r,{}),"Retour aux commandes"]})]})})})};export{p as default};
